##### Формальные степенные ряды. Производящие функции. Операции над формальными степенными рядами. Критерий обратимости ряда. Примеры. Решение линейных рекуррентных соотношений с помощью степенных рядов. Теорема Эйлера о производящей функции для $p(n)$. Производящие функции для числа разбиений ${p_{\text{odd}}(n), \ p_{ \text{ dist }}(n)}$ на нечётные слагаемые и различных слагаемые. Доказательство равенства $p_{\text{odd}}(n) = p_{\text{dist}}(n)$ (без док-ва). Пентагональная теорема Эйлера. Рекуррентная формула для $p(n)$. 
---

Формальные степенные ряды и производящие функции

Формальный степенной ряд — это алгебраическая структура вида $\displaystyle f(x)=\sum_{n=0}^{\infty}a_nx^n$, где коэффициенты $a_n$ образуют последовательность. Операции над рядами:
- Сложение/вычитание: поэлементно.
- Умножение (свёртка): $\displaystyle  f(x)g(x)=\sum_{n=0}^{\infty}\left(\sum_{k=0}^na_kb_{n-k}\right)x^n$.
- Обращение: ряд $f(x)$ обратим тогда и только тогда, когда $a_0\neq0$. Обратный ряд $g(x)$ находится рекуррентно из условия $f(x)g(x)=1$.



Решение линейных рекуррентных соотношений
Для уравнения второго порядка:
$$
x_n+d_1x_{n-1}+d_2x_{n-2}=0\quad(n\geq2),
$$
характеристический многочлен $P(\lambda)=\lambda^2+d_1\lambda+d_2$.

Случай 1: Различные корни $\lambda_1\neq\lambda_2$:
$$
x_n=C_1\lambda_1^n+C_2\lambda_2^n.
$$

Случай 2: Кратный корень $\lambda_1=\lambda_2=\alpha$:
$$
x_n=(C_1+C_2n)\alpha^n.
$$

Производящая функция для рекуррентного соотношения:
$$
f(x)=\frac{a_0+(a_1+d_1a_0)x}{1+d_1x+d_2x^2}.
$$
После разложения на простые дроби коэффициенты $a_n$ выражаются через корни $\lambda_1,\lambda_2$.


Теорема Эйлера о разбиениях
Число разбиений $p(n)$ — количество способов представить $n$ в виде суммы натуральных чисел. Производящая функция:
$$
\sum_{n=0}^\infty p(n)x^n=\prod_{k=1}^\infty\frac{1}{1-x^k}.
$$

Разбиения на нечётные слагаемые $(p_{\text{odd}}(n))$:
$$
\prod_{k=1}^\infty\frac{1}{1-x^{2k-1}}.
$$

Разбиения на различные слагаемые $(p_{\text{dist}}(n))$:
$$
\prod_{k=1}^\infty(1+x^k).
$$

Доказательство равенства $p_{\text{odd}}(n)=p_{\text{dist}}(n)$:
$$
\prod_{k=1}^\infty(1+x^k)=\prod_{k=1}^\infty\frac{1-x^{2k}}{1-x^k}=\prod_{k=1}^\infty\frac{1}{1-x^{2k-1}}.
$$
Здесь каждое чётное слагаемое $x^{2k}$ исключается, остаются только нечётные.


Пентагональная теорема Эйлера
Связывает производящую функцию разбиений с пентагональными числами:
$$
\prod_{k=1}^\infty(1-x^k)=\sum_{n=-\infty}^\infty(-1)^nx^{\frac{n(3n-1)}{2}}.
$$
Пентагональные числа имеют вид $\dfrac{n(3n-1)}{2}$.

Рекуррентная формула для $p(n)$:
$$
p(n)=\sum_{k=1}^\infty(-1)^{k+1}\left[p\left(n-\frac{k(3k-1)}{2}\right)+p\left(n-\frac{k(3k+1)}{2}\right)\right].
$$

