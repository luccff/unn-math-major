Метод левых прямоугольников.

Пусть есть ${\displaystyle f(x)\geq 0}$ на ${\displaystyle [a, \ b]}$.

график

$$\displaylines{
\int_{ a }^{ b } f(x) \, dx \approx f(a) \cdot \frac{b-a}{2}  + f\left( \frac{a+b}{2}  \right) \cdot \frac{b-a}{2}   = \frac{b-a}{2} \left( f(a) - f\left( \frac{a+b}{2}  \right) \right)
}$$

график

$$\displaylines{
\int _{ a }^{ b }f(x) \, dx \approx f(a) \Delta x + f(a+\Delta x)\Delta x + f(a+2\Delta x) \Delta x + f(a+3\Delta x)\Delta x = \\ = \Delta x(f(a)+f(a+\Delta x) + f(a+2\Delta x) + f(a+3\Delta x)) 
}$$

Запишем общую формулу:
$$\displaylines{
\boxed{\int _{ a }^{ b } f(x) \, dx  \approx \Delta x \sum_{k=0}^{n-1} f(a + k\Delta x), \  \text{где } \Delta x = \frac{b-a}{n} }
}$$

Пример.
$$\displaylines{
\int _{ 0 }^{ 1 } x^{ 2 } \, dx \text{ методом } \textbf{ левых } \text{ прямоугольников при } n = 5.
}$$
Решение:
$$\displaylines{
\begin{aligned}
a = 0 \\
b = 1 \\
n = 5
\end{aligned} \implies \Delta x = \frac{b-a}{n} = \frac{1}{5} = 0.2 
}$$

график 

Получаем:
$$\displaylines{
\int _{ 0 }^{ 1 } x^{ 2 } \, dx = [f(0) + f(0.2) + f(0.4) + f(0.6) + f(0.8)] \cdot  0.2 = 1.2 \cdot  0.2 = 0.24
}$$

Найдем ошибку:
$$\displaylines{
\int _{ 0 }^{ 1 } x^{ 2 } \, dx  = \frac{x^{ 3 }}{3} \bigg|_{ 0 }^{ 1 } = \frac{1}{3} \sim 0.33 \\
\implies  \text{ ошибка: } |0.33 - 0.24|\approx 0.07
}$$

Пример.
$$\displaylines{
\int _{ 0 }^{ 1 } x^{ 2 } \, dx \text{ методом } \textbf{ правых } \text{   прямоугольников при } n = 5.
}$$
Решение:
$$\displaylines{
\begin{aligned}
a = 0 \\
b = 1 \\
n = 5
\end{aligned} \implies \Delta x = \frac{b-a}{n} = \frac{1}{5} = 0.2 
}$$

график 

Получаем:
$$\displaylines{
\int _{ 0 }^{ 1 } x^{ 2 } \, dx = [f(0.2) + f(0.4) + f(0.6) + f(0.8) + f(1)] \cdot  0.2 = 2.2 \cdot  0.2 = 0.44
}$$

Найдем ошибку:
$$\displaylines{
\int _{ 0 }^{ 1 } x^{ 2 } \, dx  = \frac{x^{ 3 }}{3} \bigg|_{ 0 }^{ 1 } = \frac{1}{3} \sim 0.33 \\
\implies  \text{ ошибка: } |0.33 - 0.44|\approx 0.11
}$$

Метод центральных прямоугольников.

Пусть есть ${\displaystyle f(x)\geq 0}$ на ${\displaystyle [a, \ b]}$.

график

$$\displaylines{
\int_{ a }^{ b } f(x) \, dx \approx f\left( \frac{a+ a + \Delta x}{2}  \right)\Delta x  + f\left( \frac{a+\Delta x+b}{2}  \right)\Delta x   = \Delta x \left( f\left( \frac{2a + \Delta x}{2}  \right) + f\left( \frac{2a + 3\Delta x}{2}  \right) \right)
}$$

график

$$\displaylines{
\int _{ a }^{ b }f(x) \, dx \approx \Delta x \left( f\left( \frac{2a + \Delta x}{2}  \right) + f\left( \frac{2a + 3\Delta x}{2}  \right)  + f\left( \frac{2a + 5 \Delta x}{2}  \right) + f\left( \frac{2a + 7\Delta x}{2}  \right)\right)
}$$

Запишем общую формулу:
$$\displaylines{
\boxed{\int _{ a }^{ b } f(x) \, dx  \approx \Delta x \sum_{k=0}^{n-1} f\left( a + \left( k+\frac{1}{2} \right)\Delta x \right), \  \text{где } \Delta x = \frac{b-a}{n} }
}$$

Пример.
$$\displaylines{
\int _{ 0 }^{ 1 } x^{ 2 } \, dx \text{ методом } \textbf{ центральных прямоугольников } \text{ при } n = 5.
}$$
Решение:
$$\displaylines{
\begin{aligned}
a = 0 \\
b = 1 \\
n = 5
\end{aligned} \implies \Delta x = \frac{b-a}{n} = \frac{1}{5} = 0.2 
}$$

график 

Получаем:
$$\displaylines{
\int _{ 0 }^{ 1 } x^{ 2 } \, dx = [f(0.1) + f(0.3) + f(0.5) + f(0.7) + f(0.9)] \cdot  0.2 = 1.65 \cdot  0.2 = 0.33
}$$

Найдем ошибку:
$$\displaylines{
\int _{ 0 }^{ 1 } x^{ 2 } \, dx  = \frac{x^{ 3 }}{3} \bigg|_{ 0 }^{ 1 } = \frac{1}{3} \sim 0.33 \\
\implies  \text{ ошибка: } |0.333 - 0.33|\approx 0.003
}$$


Метод трапеций.

Пусть есть ${\displaystyle f(x)\geq 0}$ на ${\displaystyle [a, \ b]}$.

Как мы знаем, площадь трапеции равна ${ \frac{a+b}{2} h}$, где ${\displaystyle a, \ b}$ основания, ${\displaystyle h}$ - высота. 

график

$$\displaylines{
\int_{ a }^{ b } f(x) \, dx \approx \frac{f(a) + f(a + \Delta x)}{2} \Delta x + \frac{f(a + \Delta x) + f(a + 2\Delta x)}{2} \Delta x = \\ = \Delta x\left( \frac{f(a)}{2} + f(a+\Delta x) + \frac{f(a+ 2\Delta x)}{2}  \right) 
}$$

график

$$\displaylines{
\int _{ a }^{ b }f(x) \, dx \approx \frac{f(a) + f(a + \Delta x)}{2} \Delta x + \frac{f(a + \Delta x) + f(a + 2\Delta x)}{2} \Delta x + \\
+ \frac{f(a + 2\Delta x) + f(a + 3\Delta x)}{2} \Delta x + \frac{f(a + 3\Delta x) + f(a + 4\Delta x)}{2} \Delta x = \\
= \Delta x\left( \frac{f(a)}{2} + f(a+\Delta x) +f(a + 2\Delta x) + f(a + 3\Delta x ) +\frac{f(a+ 4\Delta x)}{2}  \right) 
}$$

Запишем общую формулу:
$$\displaylines{
\boxed{\int _{ a }^{ b } f(x) \, dx  \approx \Delta x \left( \frac{f(a) + f(a + n\Delta x)}{2}  \right) + \sum_{k=1}^{n-1} f(a+k\Delta x), \  \text{где } \Delta x = \frac{b-a}{n} }
}$$
Пример.
$$\displaylines{
\int _{ 0 }^{ 1 } x^{ 2 } \, dx \text{ методом } \textbf{ трапеций} \text{ при } n = 5.
}$$
Решение:
$$\displaylines{
\begin{aligned}
a = 0 \\
b = 1 \\
n = 5
\end{aligned} \implies \Delta x = \frac{b-a}{n} = \frac{1}{5} = 0.2 
}$$

график 

Получаем:
$$\displaylines{
\int _{ 0 }^{ 1 } x^{ 2 } \, dx = \left[ \frac{f(0) + f(0.2)}{2} + \frac{f(0.2) + f(0.4)}{2} + \dots + \frac{f(0.8) + f(1)}{2} \right] \cdot  0.2 = 1.7 \cdot  0.2 = 0.34
}$$

Найдем ошибку:
$$\displaylines{
\int _{ 0 }^{ 1 } x^{ 2 } \, dx  = \frac{x^{ 3 }}{3} \bigg|_{ 0 }^{ 1 } = \frac{1}{3} \sim 0.33 \\
\implies  \text{ ошибка: } |0.333 - 0.34|\approx 0.007
}$$

Назревает вполне ожидаемый вопрос, почему ошибка метода трапеций больше, чем метод центральных прямоугольников?

$$\displaylines{
\varepsilon_{ tr. } > \varepsilon_{ c. \ rec. }
}$$


график график

$$\displaylines{
S_{ ABCD } = S_{ AEFD } (\text{т.к. } \Delta EBG = \Delta GCF ) \\
\text{ Метод Ц.П: } |S_{ AEFD } - S_{ f(x) }| = S_{ \Delta HEG } + S_{ \Delta GCF } \\
\text{ Метод Трапеций: } |S_{ f(x) } - S_{ AHCD }| = S_{ \Delta HGC }
}$$
Очевидно, что ${\displaystyle S_{ \Delta HEG } + S_{ \Delta GCF } < S_{ \Delta HGC }}$.

Метод Симпсона (метод парабол).

Пусть ${\displaystyle f(x) \geq 0}$. Разбиваем ${\displaystyle [a; \ b]}$ на ${\displaystyle n}$ частей, где ${\displaystyle n}$ - четное.

график

Рассмотрим ${\displaystyle f(x)}$ на ${\displaystyle [-\Delta x; \ \Delta x]}$.

график

$$\displaylines{
g(x) = ax^{ 2 } + bx + c \\
g(x) = f(x) \text{ при } x =0; \ \pm \Delta x
}$$
1. ${\displaystyle g(0) = f(0) \implies c = f(0)}$
2. ${\displaystyle g(\Delta x) = f(\Delta x) \implies a \Delta x ^{ 2 } + b\Delta x + c = f(\Delta x)}$
3. ${\displaystyle g(-\Delta x ) = f(- \Delta x) \implies a \Delta x^{ 2 } - b \Delta x + c = f(-\Delta x)}$

Сложим 2. и 3.:
$$\displaylines{
2a \Delta x^{ 2 } + 2c = f(\Delta x) + f(-\Delta x)  \bigg|:2 \\
a\Delta x^{ 2 } + f(0) = \frac{f(\Delta x) + f(-\Delta x)}{2}  \quad \bigg| - f(0) \\
a \Delta x^{ 2 } = \frac{f(\Delta x) - 2f(0) + f(- \Delta x)}{2}  \quad \bigg|:\Delta x^{ 2 } \\
a = \frac{f(\Delta x) - 2f(0) + f(-\Delta x)}{2\Delta x^{ 2 }} 
}$$

Найдем площадь под ${\displaystyle g(x):}$
$$\displaylines{
\int _{ -\Delta x }^{ \Delta x } (ax^{ 2 } + bx + c) \, dx  = \int _{ -\Delta x }^{ \Delta x } (ax^{ 2 } + c) \, dx  + \underbrace{ \int _{ -\Delta x }^{ \Delta x } bx \, dx  }_{ = 0 } = 2\int _{ 0 }^{ \Delta x } (ax^{ 2 } + c) \, dx = \frac{2ax^{ 3 }}{3} + 2cx \bigg|_{ 0 }^{ \Delta x } = \\
= \frac{2a\Delta x^{ 3 }}{3} + 2c\Delta x
}$$

Тогда:
$$\displaylines{
\int _{ -\Delta x }^{ \Delta x } (ax^{ 2 } + bx + c) \, dx = \frac{f(\Delta x) - 2f(0) + f(-\Delta x)}{3} \Delta x + 2f(0) \Delta x = \frac{f(\Delta x) + 4f(0) + f(-\Delta x)}{3} \Delta x  
}$$
Так как площадь не зависит от сдвига по горизонтали, то:

график график

Значит:
$$\displaylines{
-\Delta x \to  a \\
0 \to  a + \Delta x \\
\Delta x \to a + 2\Delta x
}$$

Значит, ${\displaystyle S}$ под параболой на ${\displaystyle [a, \ a+2\Delta x]}$ равна: ${\displaystyle \frac{1}{3} (f (a + 2\Delta x) + 4 f(a + \Delta x) + f(a)) \Delta x}$.

$$\displaylines{
S \approx \frac{f(a) + 4f(a+\Delta x) + f(a + 2\Delta x)}{3} \Delta x + \frac{f(a + 2\Delta x) + 4f(a + 3\Delta x) + f(a + 4\Delta x)}{3} \Delta x + \dots  = \\ 
 \begin{aligned}
=\frac{\Delta x}{3} ( f(a) + 4f(a + \Delta x) + 2f(a+2\Delta x) + 4f(a+3\Delta x) + 2f(a+4\Delta x) + \dots \\  + 2f(a+(n-2)\Delta x) + 4f(a + (n-1) \Delta x)  + f(a + n\Delta x) )
\end{aligned}
}$$
$$\displaylines{
\int _{ a }^{ b } f(x) \, dx \approx \frac{\Delta x}{3} \left( f(a) - f(a+n\Delta x) + \sum_{k=1}^{n/2} 4f(a+(2k-1)\Delta x) + \sum_{k=1}^{n/2} 2f(a+2k\Delta x) \right) = \\
= \frac{\Delta x}{3} \left( f(a) - f(a + n\Delta x) + \sum_{k=1}^{n/2} (4f (a+(2k-1)\Delta x) + 2f(a+2k\Delta x)) \right)
}$$

Пример.
$$\displaylines{
\int _{ 1 }^{ 2 } \frac{1}{x} \, dx \text{ методом Симпсона при } n = 10.
}$$

график

Решение:
$$\displaylines{
\begin{aligned}
a = 1 \\
b = 2 \\
n = 10
\end{aligned} \implies  \Delta x = \frac{b-a}{n} = 0.1 \\
\int _{ 1 }^{ 2 } \frac{1}{x} \, dx  \approx \frac{0.1}{3} \bigg(f(1 ) + f(1.1) + 2f(1.2) + 4f(1.3) + \dots  + 4f(1.9) + f(2)\bigg) = \\
= \frac{1}{30} \left( 1 + \frac{40}{11} + \frac{5}{3} + \frac{40}{13} + \frac{10}{7} + \dots  + \frac{40}{19} + \frac{1}{2} \right) \sim 0.693150
}$$

Найдем значение интеграла:
$$\displaylines{
\int _{ 0 }^{ 1 } \frac{1}{x} \, dx  = \ln|x|  \bigg|_{ 1 }^{ 2 } = \ln(2) - \ln(1) = \ln(2) = 0.693147 \\
\text{ Ошибка: } |\ln(2) - 0.693150| = 3 \cdot  10 ^{ -6 }
}$$

Верхняя граница ошибки для каждого из методов:
$$\displaylines{
\begin{array}{|c|c|c|}
\hline 
\text{ Метод } & \text{ Верхняя граница ошибки } \\
\hline \\
\begin{aligned}
&\text{ Метод центральных }  \\
&\text{ прямоугольников }
\end{aligned} & \left| \dfrac{\displaystyle\max_{ a\leq x\leq b } f''(x) (b-a)^{ 3 }}{24n^{ 2 }}  \right|  \\ \\
\hline \\
\begin{aligned}
&\text{ Метод трапеций }
\end{aligned} & \left| \dfrac{\displaystyle\max_{ a\leq x\leq b } f''(x) (b-a)^{ 3 }}{12n^{ 2 }}  \right|  \\ \\
\hline \\
\begin{aligned}
&\text{ Метод Симпсона } 
\end{aligned} & \left| \dfrac{\displaystyle\max_{ a\leq x\leq b } f^{ (4) }(x) (b-a)^{ 5 }}{180n^{ 4 }}  \right|  \\ \\
\hline 
\end{array}
}$$

Пример. Для гиперболы ${\displaystyle y = \frac{1}{x}}$ на ${\displaystyle [1, \ 2]}$ определить минимальное ${\displaystyle n}$, при котором ошибка численного интегрирования тремя методами будет ${\displaystyle \leq 0.0001}$.

Решение:
$$\displaylines{
f(x) = \frac{1}{x} = x^{ -1 } \\
f'(x) = -x^{ -2 } \\
f''(x) = \frac{2}{x^{ 3 }} \\
|f''(x)| = \left| \frac{2}{x^{ 3 }} \right| \stackrel{ [1; \ 2] }{ \leq  } \frac{2}{1^{ 3 }} = 2 = \max_{ [1; \ 2] } f''(x)
}$$

Метод центральных прямоугольников:
$$\displaylines{
\varepsilon_{ c. rec. } = \left| \dfrac{\displaystyle\max_{ a\leq x\leq b } f''(x) (b-a)^{ 3 }}{24n^{ 2 }}  \right| = \frac{2(2-1)^{ 3 }}{24n^{ 2 }} \leq 0.0001 \\
\frac{1}{n^{ 2 }} \leq 0.0012 \\
n^{ 2 } \geq \frac{1}{0.0012} = 833,(3) \\
\text{ При } n = 29: n^{ 2 } = 841 \geq 833, (3)
}$$
Ответ: ${\displaystyle n = 29}$.

Метод трапеций:
$$\displaylines{
\varepsilon_{ tr. } = \left| \dfrac{\displaystyle\max_{ a\leq x\leq b } f''(x) (b-a)^{ 3 }}{12n^{ 2 }}  \right| = \frac{2(2-1)^{ 3 }}{12n^{ 2 }} \leq  0.0001 \\
\frac{1}{n^{ 2 } } \leq 0.0006 \\
n^{ 2 } = 1666, (6) \\
\text{ При } n = 41: n^{ 2 } = 1681 \geq  1666, (6)
}$$
Ответ: ${\displaystyle n = 41}$.

Метод Симпсона:
$$\displaylines{
\varepsilon_{ s. } = \left| \dfrac{\displaystyle\max_{ a\leq x\leq b } f^{ (4) }(x) (b-a)^{ 5 }}{180n^{ 4 }}  \right| = \frac{24 \cdot  1^{ 5 }}{180n^{ 4 }} \leq 0.0001 \\
n^{ 4 } \geq  \frac{24}{0.018} = 1333, (3) \\
\text{ При } n = 7: n^{ 7 } = 2401\geq 1333, (3) \\
n = 8 - \text{ минимальное чётное. }
}$$
Ответ: ${\displaystyle n = 8}$.